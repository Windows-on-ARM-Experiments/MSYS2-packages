--- a/sim/Makefile.in
+++ b/sim/Makefile.in
@@ -4841,6 +4841,7 @@ common/version.c-stamp: $(srcroot)/gdb/version.in $(srcroot)/bfd/version.h $(src
 	( \
 	echo '/* Do not modify this file.  */'; \
 	echo '/* It is created automatically by the Makefile.  */'; \
+	echo '#include "defs.h"'; \
 	echo '#include "libiberty.h"'; \
 	echo '#include "sim-module.h"'; \
 	sed -e 's:\(.*\):extern MODULE_INIT_FN \1;:' $@.l-tmp; \
--- a/sim/common/local.mk
+++ b/sim/common/local.mk
@@ -146,6 +146,7 @@ GEN_MODULES_C_SRCS = \
 	( \
 	echo '/* Do not modify this file.  */'; \
 	echo '/* It is created automatically by the Makefile.  */'; \
+	echo '#include "defs.h"'; \
 	echo '#include "libiberty.h"'; \
 	echo '#include "sim-module.h"'; \
 	sed -e 's:\(.*\):extern MODULE_INIT_FN \1;:' $@.l-tmp; \
